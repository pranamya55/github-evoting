<!--
  ~ (c) Copyright 2025 Swiss Post Ltd.
  -->
<h1 class="mb-4 fs-inherit d-flex align-items-center">
	<span aria-hidden="true" class="stepper-indicator">5</span>
	{{ 'verify.main.verifyverificationcodes' | translate }}
</h1>

@if (voteSentButNotCastInPreviousSession()) {
	<p class="alert alert-warning" id="warningSentButNotCast" role="alert">
		{{ 'verify.warning.abandonedprocess' | translate }}
	</p>
}

<h2>
	{{ 'verify.main.checkcodes' | translate }}
</h2>
<p>
	{{ 'verify.main.checkagainstvotingcard' | translate }}
</p>

<div class="section-title">
	<vp-icon class="voting-card-symbol" name="voting-card-diamond"></vp-icon>
	<h3 class="flex-fill m-0">{{ 'verify.main.choicecodes' | translate }}</h3>
	<button
		(click)="showFAQ(FAQSection.WhatAreChoiceReturnCodes)"
		class="btn btn-link btn-faq"
		id="show-faq-choice-codes-link"
		type="button"
	>
		<vp-icon name="question-circle"></vp-icon>
		<span>{{ 'verify.main.choicecodes.help' | translate }}</span>
	</button>
</div>

@for (
	texts of votesTexts()
		| concat: electionsTexts()
		| sortBy: 'votePosition/electionGroupPosition';
	track $index
) {
	<div class="ballot-group my-4 my-sm-5">
		@if (isVoteTexts(texts) && texts; as voteTexts) {
			<vp-accordion-vote [voteTexts]="voteTexts" [headingLevel]="4">
				<ng-template
					let-ballotIdentification="ballotIdentification"
					let-question="question"
				>
					<vp-verify-vote-question
						[voteIdentification]="voteTexts.voteIdentification"
						[ballotIdentification]="ballotIdentification"
						[question]="question"
					/>
				</ng-template>
			</vp-accordion-vote>
		}

		@if (isElectionTexts(texts) && texts; as electionTexts) {
			<section>
				<vp-verify-election-group
					[electionTexts]="electionTexts"
					class="d-flex flex-column gap-5"
				/>
			</section>
		}
	</div>
}

<vp-footer [cancelMode]="CancelMode.LeaveProcess">
	<button class="btn btn-dark flex-grow-1" routerLink="/cast" type="button">
		<vp-icon name="check-circle"></vp-icon>
		<span>{{ 'verify.main.codesmatch' | translate }}</span>
	</button>

	<button
		(click)="openInvalidCodesModal()"
		class="btn btn-outline-danger flex-grow-1"
		id="invalid-codes"
		type="button"
	>
		<vp-icon name="dash-circle"></vp-icon>
		<span>{{ 'verify.main.codesdonotmatch' | translate }}</span>
	</button>
</vp-footer>
